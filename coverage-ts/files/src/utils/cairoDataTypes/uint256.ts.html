
  <!DOCTYPE html>
  <html>
    <head>
      <title>uint256.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/utils/cairoDataTypes/uint256.ts</td><td class="">98.68%</td><td class="">80%</td><td class="">151</td><td class="">149</td><td class="">2</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">/* eslint-disable no-bitwise */
/**
 * Singular class handling cairo u256 data type
 */

import { BigNumberish, Uint256 } from &#x27;../../types&#x27;;
import { addHexPrefix } from &#x27;../encode&#x27;;
import { CairoFelt } from &#x27;./felt&#x27;;

export const UINT_128_MAX = (1n &lt;&lt; 128n) - 1n;
export const UINT_256_MAX = (1n &lt;&lt; 256n) - 1n;
export const UINT_256_MIN = 0n;
export const UINT_256_LOW_MAX = 340282366920938463463374607431768211455n;
export const UINT_256_HIGH_MAX = 340282366920938463463374607431768211455n;
export const UINT_256_LOW_MIN = 0n;
export const UINT_256_HIGH_MIN = 0n;

export class CairoUint256 {
  public low: bigint;

  public high: bigint;

  static abiSelector = &#x27;core::integer::u256&#x27;;

  /**
   * Default constructor (Lib usage)
   * @param bigNumberish BigNumberish value representing uin256
   */
  public constructor(bigNumberish: BigNumberish);
  /**
   * Direct props initialization (Api response)
   */
  public constructor(low: BigNumberish, high: BigNumberish);
  /**
   * Initialization from Uint256 object
   */
  public constructor(uint256: Uint256);

  public constructor(...arr: any[]) {
    if (typeof arr[0] === &#x27;object&#x27; &amp;&amp; arr.length === 1 &amp;&amp; &#x27;low&#x27; in arr[0] &amp;&amp; &#x27;high&#x27; in arr[0]) {
      const props = CairoUint256.validateProps(arr[0].low, arr[0].high);
      this.low = props.low;
      this.high = props.high;
    } else if (arr.length === 1) {
      const bigInt = CairoUint256.validate(arr[0]);
      this.low = bigInt &amp; UINT_128_MAX;
      this.high = bigInt &gt;&gt; 128n;
    } else if (arr.length === 2) {
      const props = CairoUint256.validateProps(arr[0], arr[1]);
      this.low = props.low;
      this.high = props.high;
    } else {
      throw Error(&#x27;Incorrect constructor parameters&#x27;);
    }
  }

  /**
   * Validate if BigNumberish can be represented as Unit256
   */
  static validate(bigNumberish: BigNumberish) {
    const bigInt = BigInt(bigNumberish);
    if (bigInt &lt; UINT_256_MIN) throw Error(&#x27;bigNumberish is smaller than UINT_256_MIN&#x27;);
    if (bigInt &gt; UINT_256_MAX) throw new Error(&#x27;bigNumberish is bigger than UINT_256_MAX&#x27;);
    return bigInt;
  }

  /**
   * Validate if low and high can be represented as Unit256
   */
  static validateProps(low: BigNumberish, high: BigNumberish) {
    const bigIntLow = BigInt(low);
    const bigIntHigh = BigInt(high);
    if (bigIntLow &lt; UINT_256_LOW_MIN || bigIntLow &gt; UINT_256_LOW_MAX) {
      throw new Error(&#x27;low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX&#x27;);
    }
    if (bigIntHigh &lt; UINT_256_HIGH_MIN || bigIntHigh &gt; UINT_256_HIGH_MAX) {
      throw new Error(&#x27;high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX&#x27;);
    }
    return { low: bigIntLow, high: bigIntHigh };
  }

  /**
   * Check if BigNumberish can be represented as Unit256
   */
  static is(bigNumberish: BigNumberish) {
    try {
      CairoUint256.validate(bigNumberish);
    } catch (error) {
      return false;
    }
    return true;
  }

  /**
   * Check if provided abi type is this data type
   */
  static isAbiType(abiType: string) {
    return abiType === CairoUint256.abiSelector;
  }

  /**
   * Return bigint representation
   */
  toBigInt() {
    return (this.high &lt;&lt; 128n) + this.low;
  }

  /**
   * Return Uint256 structure with HexString props
   * {low: HexString, high: HexString}
   */
  toUint256HexString() {
    return {
      low: addHexPrefix(this.low.toString(16)),
      high: addHexPrefix(this.high.toString(16)),
    };
  }

  /**
   * Return Uint256 structure with DecimalString props
   * {low: DecString, high: DecString}
   */
  toUint256DecimalString() {
    return {
      low: this.low.toString(10),
      high: this.high.toString(10),
    };
  }

  /**
   * Return api requests representation witch is felt array
   */
  toApiRequest() {
    return [CairoFelt(this.low), CairoFelt(this.high)];
  }
}
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;src/utils/cairoDataTypes/uint256.ts&quot;,&quot;line&quot;:40,&quot;character&quot;:54,&quot;text&quot;:&quot;low&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/utils/cairoDataTypes/uint256.ts&quot;,&quot;line&quot;:40,&quot;character&quot;:66,&quot;text&quot;:&quot;high&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 25 Apr 2024 15:57:37 GMT</p>
    </body>
  </html>
  